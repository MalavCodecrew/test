{{ 'customcollection.css' | asset_url | stylesheet_tag }}
{{ 'component-accordion.css' | asset_url | stylesheet_tag }}
{{ 'component-price.css' | asset_url | stylesheet_tag }}
{{ 'component-rating.css' | asset_url | stylesheet_tag }}
{{ 'component-volume-pricing.css' | asset_url | stylesheet_tag }}
{{ 'quick-add.css' | asset_url | stylesheet_tag }}
{{ 'quick-order-list.css' | asset_url | stylesheet_tag }}
{{ 'quantity-popover.css' | asset_url | stylesheet_tag }}
{{ 'component-product-variant-picker.css' | asset_url | stylesheet_tag }}
{{ 'component-cart-notification.css' | asset_url | stylesheet_tag }}
{{ 'upsell-product.css' | asset_url | stylesheet_tag }}
<script src="{{ 'quickview.js' | asset_url }}" defer="defer"></script>
<script src="{{ 'show-more.js' | asset_url }}" defer="defer"></script>
<script src="{{ 'price-per-item.js' | asset_url }}" defer="defer"></script>
<script src="{{ 'product-form.js' | asset_url }}" defer="defer"></script>
<script src="{{ 'product-info.js' | asset_url }}" defer="defer"></script>
<script src="{{ 'quantity.js' | asset_url }}" defer="defer"></script>
<script src="{{ 'quantity-popover.js' | asset_url }}" defer="defer"></script>
<script src="{{ 'quick-add.js' | asset_url }}" defer="defer"></script>
<script src="{{ 'quick-add-bulk.js' | asset_url }}" defer="defer"></script>
<script src="{{ 'add-cart.js' | asset_url }}" defer="defer"></script>
<script src="{{ 'cart-notification.js' | asset_url }}" defer="defer"></script>
<script src="{{ 'popup.js' | asset_url }}" defer="defer"></script>
{% if section.settings.image_zoom == 'hover' %}
  <script id="EnableZoomOnHover-main" src="{{ 'magnify.js' | asset_url }}" defer="defer"></script>
{% endif %}
{%- if request.design_mode -%}
  <script src="{{ 'theme-editor.js' | asset_url }}" defer="defer"></script>
{%- endif -%}

<div class="quick-main">
  {% if section.settings.collection != blank %}
    <div class="collection-grid">
      {%- for product in section.settings.collection.products %}
        <div class="item">
          <div class="image">
            <img src="{{product.featured_media | img_url: '' }} " class="primary-image">
            {% if product.media.size > 1 %}
              <img src="{{ product.media[1] | img_url: '' }}" class="secondary-image">
            {% endif %}
            <div class="quick-view-btn">
              <a class="button" id="{{ product.id }}">Quick View</a>
              <svg xmlns="http://www.w3.org/2000/svg" width="50px" height="50px" viewBox="0 0 24 24" fill="none">
                <path d="M21 5L19 12H7.37671M20 16H8L6 3H3M16 5.5H13.5M13.5 5.5H11M13.5 5.5V8M13.5 5.5V3M9 20C9 20.5523 8.55228 21 8 21C7.44772 21 7 20.5523 7 20C7 19.4477 7.44772 19 8 19C8.55228 19 9 19.4477 9 20ZM20 20C20 20.5523 19.5523 21 19 21C18.4477 21 18 20.5523 18 20C18 19.4477 18.4477 19 19 19C19.5523 19 20 19.4477 20 20Z" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>

              <div {{ block.shopify_attributes }}>
                {%- if product != blank -%}
                  {%- liquid
                    assign gift_card_recipient_feature_active = false
                    if block.settings.show_gift_card_recipient and product.gift_card?
                      assign gift_card_recipient_feature_active = true
                    endif

                    assign show_dynamic_checkout = false
                    if block.settings.show_dynamic_checkout and gift_card_recipient_feature_active == false
                      assign show_dynamic_checkout = true
                    endif
                  -%}

                  <product-form
                    class="product-form"
                    data-hide-errors="{{ gift_card_recipient_feature_active }}"
                    data-section-id="{{ section.id }}"
                  >
                    <form
                      id="product-form-{{ product.id }}"
                      class="form"
                      novalidate="novalidate"
                      action="/cart/add"
                      method="post"
                      enctype="multipart/form-data"
                      data-type="add-to-cart-form"
                    >
                      {%- unless product.has_only_default_variant -%}
                        <quick-info-variant-selects
                          id="variant-selects-{{ section.id }}"
                          data-section="{{ section.id }}"
                          data-url="{{ product.url }}"
                          {% if update_url == false %}
                            data-update-url="false"
                          {% endif %}
                          {{ block.shopify_attributes }}
                        >
                          {%- for option in product.options_with_values -%}
                            {%- liquid
                              assign swatch_count = option.values | map: 'swatch' | compact | size
                              assign picker_type = 'button'

                              if swatch_count > 0 and block.settings.swatch_shape != 'none'
                                if block.settings.picker_type == 'dropdown'
                                  assign picker_type = 'swatch_dropdown'
                                else
                                  assign picker_type = 'swatch'
                                endif
                              endif
                            -%}
                            {%- if picker_type == 'button' -%}
                              <fieldset class="js product-form__input product-form__input--pill">
                                <legend class="form__label">{{ option.name }}</legend>
                                {% render 'product-variant-options',
                                  product: product,
                                  option: option,
                                  block: block,
                                  picker_type: picker_type
                                %}
                              </fieldset>
                            {%- endif -%}
                          {%- endfor -%}
                          <script type="application/json">
                            {{ product.variants | json }}
                          </script>
                        </quick-info-variant-selects>
                      {%- endunless -%}

                      <div class="quantity">
                        <button type="button" class="quantity__button minus">-</button>
                        <input class="quantity__input" type="number" name="quantity" value="1" min="1">
                        <button type="button" class="quantity__button plus">+</button>
                      </div>
                      <div class="product-form__error-message-wrapper" role="alert" hidden>
                        <svg
                          aria-hidden="true"
                          focusable="false"
                          class="icon icon-error"
                          viewBox="0 0 13 13"
                        >
                          <circle cx="6.5" cy="6.50049" r="5.5" stroke="white" stroke-width="2"/>
                          <circle cx="6.5" cy="6.5" r="5.5" fill="#EB001B" stroke="#EB001B" stroke-width="0.7"/>
                          <path d="M5.87413 3.52832L5.97439 7.57216H7.02713L7.12739 3.52832H5.87413ZM6.50076 9.66091C6.88091 9.66091 7.18169 9.37267 7.18169 9.00504C7.18169 8.63742 6.88091 8.34917 6.50076 8.34917C6.12061 8.34917 5.81982 8.63742 5.81982 9.00504C5.81982 9.37267 6.12061 9.66091 6.50076 9.66091Z" fill="white"/>
                          <path d="M5.87413 3.17832H5.51535L5.52424 3.537L5.6245 7.58083L5.63296 7.92216H5.97439H7.02713H7.36856L7.37702 7.58083L7.47728 3.537L7.48617 3.17832H7.12739H5.87413ZM6.50076 10.0109C7.06121 10.0109 7.5317 9.57872 7.5317 9.00504C7.5317 8.43137 7.06121 7.99918 6.50076 7.99918C5.94031 7.99918 5.46982 8.43137 5.46982 9.00504C5.46982 9.57872 5.94031 10.0109 6.50076 10.0109Z" fill="white" stroke="#EB001B" stroke-width="0.7">
                        </svg>
                        <span class="product-form__error-message"></span>
                      </div>

                      <input
                        type="hidden"
                        name="id"
                        value="{{ product.selected_or_first_available_variant.id }}"
                        {% if product.selected_or_first_available_variant.available == false or quantity_rule_soldout %}
                          disabled
                        {% endif %}
                        class="product-variant-id"
                      >

                      {%- if gift_card_recipient_feature_active -%}
                        {%- render 'gift-card-recipient-form', product: product, form: form, section: section -%}
                      {%- endif -%}

                      <div class="product-form__buttons">
                        {%- liquid
                          assign check_against_inventory = true
                          if product.selected_or_first_available_variant.inventory_management != 'shopify' or product.selected_or_first_available_variant.inventory_policy == 'continue'
                            assign check_against_inventory = false
                          endif
                          if product.selected_or_first_available_variant.quantity_rule.min > product.selected_or_first_available_variant.inventory_quantity and check_against_inventory
                            assign quantity_rule_soldout = true
                          endif
                        -%}
                        <button
                          id="ProductSubmitButton-{{ section_id }}"
                          type="submit"
                          name="add"

                          class="product-form__submit button button--full-width {% if show_dynamic_checkout %}button--secondary{% else %}button--primary{% endif %}"
                          {% if product.selected_or_first_available_variant.available == false
                            or quantity_rule_soldout
                          %}
                            disabled
                          {% endif %}
                        >
                          <span>
                            {%- if product.selected_or_first_available_variant.available == false
                              or quantity_rule_soldout
                            -%}
                              {{ 'products.product.sold_out' | t }}
                            {%- else -%}
                              {{ 'products.product.add_to_cart' | t }}
                            {%- endif -%}
                          </span>

                          {%- render 'loading-spinner' -%}
                        </button>
                        {%- if show_dynamic_checkout -%}
                          {{ form | payment_button }}
                        {%- endif -%}
                      </div>
                    </form>
                  </product-form>
                {%- else -%}
                  <div class="product-form">
                    <div class="product-form__buttons form">
                      <button
                        type="submit"
                        name="add"
                        class="product-form__submit button button--full-width button--primary"
                        disabled
                      >
                        {{ 'products.product.sold_out' | t }}
                      </button>
                    </div>
                  </div>
                {%- endif -%}

                {%- if show_pickup_availability -%}
                  {{ 'component-pickup-availability.css' | asset_url | stylesheet_tag }}

                  {%- assign pick_up_availabilities = product.selected_or_first_available_variant.store_availabilities
                    | where: 'pick_up_enabled', true
                  -%}

                  <pickup-availability
                    class="product__pickup-availabilities quick-add-hidden"
                    {% if product.selected_or_first_available_variant.available and pick_up_availabilities.size > 0 %}
                      available
                    {% endif %}
                    data-root-url="{{ routes.root_url }}"
                    data-variant-id="{{ product.selected_or_first_available_variant.id }}"
                    data-has-only-default-variant="{{ product.has_only_default_variant }}"
                    data-product-page-color-scheme="gradient color-{{ section.settings.color_scheme }}"
                  >
                    <template>
                      <pickup-availability-preview class="pickup-availability-preview">
                        {% render 'icon-unavailable' %}
                        <div class="pickup-availability-info">
                          <p class="caption-large">{{ 'products.product.pickup_availability.unavailable' | t }}</p>
                          <button class="pickup-availability-button link link--text underlined-link">
                            {{ 'products.product.pickup_availability.refresh' | t }}
                          </button>
                        </div>
                      </pickup-availability-preview>
                    </template>
                  </pickup-availability>

                  <script src="{{ 'pickup-availability.js' | asset_url }}" defer="defer"></script>
                {%- endif -%}
              </div>
            </div>
          </div>
          <div class="collection-text">
            {% if product.title != blank %}
              <p>{{ product.title }}</p>
            {% endif %}
            {% if product.price != blank %}
              <p>{{ product.price | money_with_currency }}</p>
            {% endif %}
          </div>
        </div>
      {% endfor %}
    </div>
  {% endif %}
  <div class="quickpopup">
    {%- assign product_form_id = 'product-form-' | append: section.id -%}
    {%- for product in section.settings.collection.products %}
      <section class="custom-popup" id="popup-{{ product.id }}">
        <div class="popup__content">
          <div class="close">
            <span></span>
            <span></span>
          </div>

          <div class="grid__item product__media-wrapper">
            <div class="quick-img">
              {% if product.media.size > 1 %}
                <img src="{{ product.media[1] | img_url: '' }}">
              {% endif %}
              <div class="variant-images">
                {%- for variant in product.variants %}
                  {%- if variant.image -%}
                    <div class="variant-block">
                      <img src="{{ variant.image | img_url: ''  }}">
                      <span class="variant-title"> {{ variant.title }}</span>
                    </div>
                  {% endif %}
                {% endfor %}
              </div>

              <!-- {% render 'product-media-gallery', product: product ,variant_images %} -->
            </div>
          </div>
          <div class="popup2">
            <div class="ProductItem__Sizes">
              {%- for variant in product.variants -%}
                {%- if variant.available -%}
                  <span class="ProductItem__Size">{{ variant.title }}</span>
                {%- endif -%}
              {%- endfor -%}
            </div>
            <div class="card__information">
              <h3
                class="card__heading"
                {% if product.featured_media == null and settings.card_style == 'standard' %}
                  id="title-{{ section_id }}-{{ product.id }}"
                {% endif %}
              >
                <!--
                  <a
                    href="{{ product.url }}"
                    id="StandardCardNoMediaLink-{{ section_id }}-{{ product.id }}"
                    class="full--custom-unstyled-link"
                    aria-labelledby="StandardCardNoMediaLink-{{ section_id }}-{{ product.id }} NoMediaStandardBadge-{{ section_id }}-{{ product.id }}"
                  >
                -->
                {{ product.title | escape }}
                <!-- </a> -->
              </h3>
              <div id="price-{{ section.id }}" role="status" {{ block.shopify_attributes }}>
                {%- render 'price',
                  product: product,
                  use_variant: true,
                  show_badges: true,
                  price_class: 'price--large'
                -%}
              </div>
            </div>

            <modal-opener
              class="product-popup-modal__opener quick-add-hidden"
              data-modal="#PopupModal-{{ block.id }}"
              {{ block.shopify_attributes }}
            >
              <button
                id="ProductPopup-{{ block.id }}"
                class="product-popup-modal__button link"
                type="button"
                aria-haspopup="dialog"
              >
                {{ block.settings.text | default: block.settings.page.title | escape }}
              </button>
            </modal-opener>

            {% liquid
              assign share_url = product.selected_variant.url | default: product.url | prepend: request.origin
              render 'share-button', block: block, share_link: share_url
            %}

            {%- render 'custom-buy-button',
              block: block,
              product: product,
              product_form_id: product_form_id,
              section_id: section.id,
              show_pickup_availability: true
            -%}
          </div>
        </div>
      </section>
    {% endfor %}
  </div>
</div>
{% schema %}
{
  "name": "customcollection",
  "settings": [
    {
  "type": "collection",
  "id": "collection",
  "label": "Collection"
}

  ],
  "presets": [
  {
    "name": "customcollection"
  }
]
}
{% endschema %}
